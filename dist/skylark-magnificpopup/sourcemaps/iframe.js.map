{"version":3,"sources":["iframe.js"],"names":["define","$","_fixIframeBugs","isShowing","mfp","currTemplate","el","find","length","src","isIE8","css","magnificPopup","registerModule","options","markup","srcAction","patterns","youtube","index","id","vimeo","gmaps","proto","initIframe","types","push","_mfpOn","e","prevType","newType","CLOSE_EVENT","getIframe","item","template","embedSrc","iframeSt","st","iframe","each","indexOf","this","substr","lastIndexOf","call","replace","dataObj","_parseMarkup","updateStatus"],"mappings":";;;;;;;AAAAA,QACC,iBACA,UACC,SAASC,GACV,IAGCC,EAAiB,SAASC,GACzB,GAAGC,IAAIC,aAAsB,OAAG,CAC/B,IAAIC,EAAKF,IAAIC,aAAsB,OAAEE,KAAK,UACvCD,EAAGE,SAEDL,IACHG,EAAG,GAAGG,IARG,iBAYPL,IAAIM,OACNJ,EAAGK,IAAI,UAAWR,EAAY,QAAU,WAM7CF,EAAEW,cAAcC,eApBA,UAsBfC,SACCC,OAAQ,6JAKRC,UAAW,aAGXC,UACCC,SACCC,MAAO,cACPC,GAAI,KACJX,IAAK,2CAENY,OACCF,MAAO,aACPC,GAAI,IACJX,IAAK,4CAENa,OACCH,MAAO,iBACPV,IAAK,uBAKRc,OACCC,WAAY,WACXpB,IAAIqB,MAAMC,KAnDG,UAqDbC,OAAO,eAAgB,SAASC,EAAGC,EAAUC,GACzCD,IAAaC,IAtDJ,WAuDRD,EACF3B,IAxDU,WAyDD4B,GACT5B,GAAe,MAOlByB,OAAOI,YAAc,UAAiB,WACrC7B,OAIF8B,UAAW,SAASC,EAAMC,GACzB,IAAIC,EAAWF,EAAKxB,IAChB2B,EAAWhC,IAAIiC,GAAGC,OAEtBrC,EAAEsC,KAAKH,EAASnB,SAAU,WACzB,GAAGkB,EAASK,QAASC,KAAKtB,QAAW,EASpC,OARGsB,KAAKrB,KAENe,EADqB,iBAAZM,KAAKrB,GACHe,EAASO,OAAOP,EAASQ,YAAYF,KAAKrB,IAAIqB,KAAKrB,GAAGZ,OAAQ2B,EAAS3B,QAEvEiC,KAAKrB,GAAGwB,KAAMH,KAAMN,IAGjCA,EAAWM,KAAKhC,IAAIoC,QAAQ,OAAQV,IAC7B,IAIT,IAAIW,KAQJ,OAPGV,EAASpB,YACX8B,EAAQV,EAASpB,WAAamB,GAE/B/B,IAAI2C,aAAab,EAAUY,EAASb,GAEpC7B,IAAI4C,aAAa,SAEVd","file":"../iframe.js","sourcesContent":["define([\n\t\"skylark-jquery\",\n\t\"./core\"\n],function($) {\n\tvar IFRAME_NS = 'iframe',\n\t\t_emptyPage = '//about:blank',\n\n\t\t_fixIframeBugs = function(isShowing) {\n\t\t\tif(mfp.currTemplate[IFRAME_NS]) {\n\t\t\t\tvar el = mfp.currTemplate[IFRAME_NS].find('iframe');\n\t\t\t\tif(el.length) {\n\t\t\t\t\t// reset src after the popup is closed to avoid \"video keeps playing after popup is closed\" bug\n\t\t\t\t\tif(!isShowing) {\n\t\t\t\t\t\tel[0].src = _emptyPage;\n\t\t\t\t\t}\n\n\t\t\t\t\t// IE8 black screen bug fix\n\t\t\t\t\tif(mfp.isIE8) {\n\t\t\t\t\t\tel.css('display', isShowing ? 'block' : 'none');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t$.magnificPopup.registerModule(IFRAME_NS, {\n\n\t\toptions: {\n\t\t\tmarkup: '<div class=\"mfp-iframe-scaler\">'+\n\t\t\t\t\t\t'<div class=\"mfp-close\"></div>'+\n\t\t\t\t\t\t'<iframe class=\"mfp-iframe\" src=\"//about:blank\" frameborder=\"0\" allowfullscreen></iframe>'+\n\t\t\t\t\t'</div>',\n\n\t\t\tsrcAction: 'iframe_src',\n\n\t\t\t// we don't care and support only one default type of URL by default\n\t\t\tpatterns: {\n\t\t\t\tyoutube: {\n\t\t\t\t\tindex: 'youtube.com',\n\t\t\t\t\tid: 'v=',\n\t\t\t\t\tsrc: '//www.youtube.com/embed/%id%?autoplay=1'\n\t\t\t\t},\n\t\t\t\tvimeo: {\n\t\t\t\t\tindex: 'vimeo.com/',\n\t\t\t\t\tid: '/',\n\t\t\t\t\tsrc: '//player.vimeo.com/video/%id%?autoplay=1'\n\t\t\t\t},\n\t\t\t\tgmaps: {\n\t\t\t\t\tindex: '//maps.google.',\n\t\t\t\t\tsrc: '%id%&output=embed'\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tproto: {\n\t\t\tinitIframe: function() {\n\t\t\t\tmfp.types.push(IFRAME_NS);\n\n\t\t\t\t_mfpOn('BeforeChange', function(e, prevType, newType) {\n\t\t\t\t\tif(prevType !== newType) {\n\t\t\t\t\t\tif(prevType === IFRAME_NS) {\n\t\t\t\t\t\t\t_fixIframeBugs(); // iframe if removed\n\t\t\t\t\t\t} else if(newType === IFRAME_NS) {\n\t\t\t\t\t\t\t_fixIframeBugs(true); // iframe is showing\n\t\t\t\t\t\t}\n\t\t\t\t\t}// else {\n\t\t\t\t\t\t// iframe source is switched, don't do anything\n\t\t\t\t\t//}\n\t\t\t\t});\n\n\t\t\t\t_mfpOn(CLOSE_EVENT + '.' + IFRAME_NS, function() {\n\t\t\t\t\t_fixIframeBugs();\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tgetIframe: function(item, template) {\n\t\t\t\tvar embedSrc = item.src;\n\t\t\t\tvar iframeSt = mfp.st.iframe;\n\n\t\t\t\t$.each(iframeSt.patterns, function() {\n\t\t\t\t\tif(embedSrc.indexOf( this.index ) > -1) {\n\t\t\t\t\t\tif(this.id) {\n\t\t\t\t\t\t\tif(typeof this.id === 'string') {\n\t\t\t\t\t\t\t\tembedSrc = embedSrc.substr(embedSrc.lastIndexOf(this.id)+this.id.length, embedSrc.length);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tembedSrc = this.id.call( this, embedSrc );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tembedSrc = this.src.replace('%id%', embedSrc );\n\t\t\t\t\t\treturn false; // break;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tvar dataObj = {};\n\t\t\t\tif(iframeSt.srcAction) {\n\t\t\t\t\tdataObj[iframeSt.srcAction] = embedSrc;\n\t\t\t\t}\n\t\t\t\tmfp._parseMarkup(template, dataObj, item);\n\n\t\t\t\tmfp.updateStatus('ready');\n\n\t\t\t\treturn template;\n\t\t\t}\n\t\t}\n\t});\n\n});"]}