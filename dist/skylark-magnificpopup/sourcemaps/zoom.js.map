{"version":3,"sources":["zoom.js"],"names":["define","$","hasMozTransform","magnificPopup","registerModule","options","enabled","easing","duration","opener","element","is","find","proto","initZoom","image","zoomSt","mfp","st","zoom","ns","supportsTransition","openTimeout","animatedImg","getElToAnimate","newImg","clone","removeAttr","addClass","transition","cssObj","position","zIndex","left","top","-webkit-backface-visibility","t","css","showMainContent","content","_mfpOn","_allowZoom","clearTimeout","_getItemToZoom","_getOffset","wrap","append","setTimeout","remove","_mfpTrigger","BEFORE_CLOSE_EVENT","removalDelay","CLOSE_EVENT","currItem","type","hasSize","img","isLarge","el","offset","paddingTop","parseInt","paddingBottom","window","scrollTop","obj","width","height","_isJQ","innerHeight","offsetHeight","undefined","document","createElement","style","MozTransform"],"mappings":"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","file":"../zoom.js","sourcesContent":["define([\n\t\"skylark-jquery\",\n\t\"./core\"\n],function($) {\n\n\tvar hasMozTransform,\n\t\tgetHasMozTransform = function() {\n\t\t\tif(hasMozTransform === undefined) {\n\t\t\t\thasMozTransform = document.createElement('p').style.MozTransform !== undefined;\n\t\t\t}\n\t\t\treturn hasMozTransform;\n\t\t};\n\n\t$.magnificPopup.registerModule('zoom', {\n\n\t\toptions: {\n\t\t\tenabled: false,\n\t\t\teasing: 'ease-in-out',\n\t\t\tduration: 300,\n\t\t\topener: function(element) {\n\t\t\t\treturn element.is('img') ? element : element.find('img');\n\t\t\t}\n\t\t},\n\n\t\tproto: {\n\n\t\t\tinitZoom: function() {\n\t\t\t\tvar zoomSt = mfp.st.zoom,\n\t\t\t\t\tns = '.zoom',\n\t\t\t\t\timage;\n\n\t\t\t\tif(!zoomSt.enabled || !mfp.supportsTransition) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar duration = zoomSt.duration,\n\t\t\t\t\tgetElToAnimate = function(image) {\n\t\t\t\t\t\tvar newImg = image.clone().removeAttr('style').removeAttr('class').addClass('mfp-animated-image'),\n\t\t\t\t\t\t\ttransition = 'all '+(zoomSt.duration/1000)+'s ' + zoomSt.easing,\n\t\t\t\t\t\t\tcssObj = {\n\t\t\t\t\t\t\t\tposition: 'fixed',\n\t\t\t\t\t\t\t\tzIndex: 9999,\n\t\t\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\t\t'-webkit-backface-visibility': 'hidden'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tt = 'transition';\n\n\t\t\t\t\t\tcssObj['-webkit-'+t] = cssObj['-moz-'+t] = cssObj['-o-'+t] = cssObj[t] = transition;\n\n\t\t\t\t\t\tnewImg.css(cssObj);\n\t\t\t\t\t\treturn newImg;\n\t\t\t\t\t},\n\t\t\t\t\tshowMainContent = function() {\n\t\t\t\t\t\tmfp.content.css('visibility', 'visible');\n\t\t\t\t\t},\n\t\t\t\t\topenTimeout,\n\t\t\t\t\tanimatedImg;\n\n\t\t\t\t_mfpOn('BuildControls'+ns, function() {\n\t\t\t\t\tif(mfp._allowZoom()) {\n\n\t\t\t\t\t\tclearTimeout(openTimeout);\n\t\t\t\t\t\tmfp.content.css('visibility', 'hidden');\n\n\t\t\t\t\t\t// Basically, all code below does is clones existing image, puts in on top of the current one and animated it\n\n\t\t\t\t\t\timage = mfp._getItemToZoom();\n\n\t\t\t\t\t\tif(!image) {\n\t\t\t\t\t\t\tshowMainContent();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tanimatedImg = getElToAnimate(image);\n\n\t\t\t\t\t\tanimatedImg.css( mfp._getOffset() );\n\n\t\t\t\t\t\tmfp.wrap.append(animatedImg);\n\n\t\t\t\t\t\topenTimeout = setTimeout(function() {\n\t\t\t\t\t\t\tanimatedImg.css( mfp._getOffset( true ) );\n\t\t\t\t\t\t\topenTimeout = setTimeout(function() {\n\n\t\t\t\t\t\t\t\tshowMainContent();\n\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\tanimatedImg.remove();\n\t\t\t\t\t\t\t\t\timage = animatedImg = null;\n\t\t\t\t\t\t\t\t\t_mfpTrigger('ZoomAnimationEnded');\n\t\t\t\t\t\t\t\t}, 16); // avoid blink when switching images\n\n\t\t\t\t\t\t\t}, duration); // this timeout equals animation duration\n\n\t\t\t\t\t\t}, 16); // by adding this timeout we avoid short glitch at the beginning of animation\n\n\n\t\t\t\t\t\t// Lots of timeouts...\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t_mfpOn(BEFORE_CLOSE_EVENT+ns, function() {\n\t\t\t\t\tif(mfp._allowZoom()) {\n\n\t\t\t\t\t\tclearTimeout(openTimeout);\n\n\t\t\t\t\t\tmfp.st.removalDelay = duration;\n\n\t\t\t\t\t\tif(!image) {\n\t\t\t\t\t\t\timage = mfp._getItemToZoom();\n\t\t\t\t\t\t\tif(!image) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tanimatedImg = getElToAnimate(image);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tanimatedImg.css( mfp._getOffset(true) );\n\t\t\t\t\t\tmfp.wrap.append(animatedImg);\n\t\t\t\t\t\tmfp.content.css('visibility', 'hidden');\n\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tanimatedImg.css( mfp._getOffset() );\n\t\t\t\t\t\t}, 16);\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\t_mfpOn(CLOSE_EVENT+ns, function() {\n\t\t\t\t\tif(mfp._allowZoom()) {\n\t\t\t\t\t\tshowMainContent();\n\t\t\t\t\t\tif(animatedImg) {\n\t\t\t\t\t\t\tanimatedImg.remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t\timage = null;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t_allowZoom: function() {\n\t\t\t\treturn mfp.currItem.type === 'image';\n\t\t\t},\n\n\t\t\t_getItemToZoom: function() {\n\t\t\t\tif(mfp.currItem.hasSize) {\n\t\t\t\t\treturn mfp.currItem.img;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// Get element postion relative to viewport\n\t\t\t_getOffset: function(isLarge) {\n\t\t\t\tvar el;\n\t\t\t\tif(isLarge) {\n\t\t\t\t\tel = mfp.currItem.img;\n\t\t\t\t} else {\n\t\t\t\t\tel = mfp.st.zoom.opener(mfp.currItem.el || mfp.currItem);\n\t\t\t\t}\n\n\t\t\t\tvar offset = el.offset();\n\t\t\t\tvar paddingTop = parseInt(el.css('padding-top'),10);\n\t\t\t\tvar paddingBottom = parseInt(el.css('padding-bottom'),10);\n\t\t\t\toffset.top -= ( $(window).scrollTop() - paddingTop );\n\n\n\t\t\t\t/*\n\n\t\t\t\tAnimating left + top + width/height looks glitchy in Firefox, but perfect in Chrome. And vice-versa.\n\n\t\t\t\t */\n\t\t\t\tvar obj = {\n\t\t\t\t\twidth: el.width(),\n\t\t\t\t\t// fix Zepto height+padding issue\n\t\t\t\t\theight: (_isJQ ? el.innerHeight() : el[0].offsetHeight) - paddingBottom - paddingTop\n\t\t\t\t};\n\n\t\t\t\t// I hate to do this, but there is no another option\n\t\t\t\tif( getHasMozTransform() ) {\n\t\t\t\t\tobj['-moz-transform'] = obj['transform'] = 'translate(' + offset.left + 'px,' + offset.top + 'px)';\n\t\t\t\t} else {\n\t\t\t\t\tobj.left = offset.left;\n\t\t\t\t\tobj.top = offset.top;\n\t\t\t\t}\n\t\t\t\treturn obj;\n\t\t\t}\n\n\t\t}\n\t});\n});\n"]}