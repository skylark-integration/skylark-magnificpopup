{"version":3,"sources":["ajax.js"],"names":["define","$","_ajaxCur","_removeAjaxCursor","document","body","removeClass","_destroyAjaxRequest","mfp","req","abort","magnificPopup","registerModule","options","settings","cursor","tError","proto","initAjax","types","push","st","ajax","_mfpOn","CLOSE_EVENT","getAjax","item","addClass","updateStatus","opts","extend","url","src","success","data","textStatus","jqXHR","temp","xhr","_mfpTrigger","appendContent","finished","_setFocus","setTimeout","wrap","READY_CLASS","error","loadError","replace"],"mappings":";;;;;;;AAAAA,QACC,iBACA,UACC,SAASC,GACV,IACCC,EACAC,EAAoB,WAChBD,GACFD,EAAEG,SAASC,MAAMC,YAAYJ,IAG/BK,EAAsB,WACrBJ,IACGK,IAAIC,KACND,IAAIC,IAAIC,SAIXT,EAAEU,cAAcC,eAdF,QAgBbC,SACCC,SAAU,KACVC,OAAQ,eACRC,OAAQ,wDAGTC,OACCC,SAAU,WACTV,IAAIW,MAAMC,KAxBC,QAyBXlB,EAAWM,IAAIa,GAAGC,KAAKP,OAEvBQ,OAAOC,YAAY,QAAajB,GAChCgB,OAAO,oBAA2BhB,IAEnCkB,QAAS,SAASC,GAEdxB,GACFD,EAAEG,SAASC,MAAMsB,SAASzB,GAG3BM,IAAIoB,aAAa,WAEjB,IAAIC,EAAO5B,EAAE6B,QACZC,IAAKL,EAAKM,IACVC,QAAS,SAASC,EAAMC,EAAYC,GACnC,IAAIC,GACHH,KAAKA,EACLI,IAAIF,GAGLG,YAAY,YAAaF,GAEzB7B,IAAIgC,cAAevC,EAAEoC,EAAKH,MAhDjB,QAkDTR,EAAKe,UAAW,EAEhBtC,IAEAK,IAAIkC,YAEJC,WAAW,WACVnC,IAAIoC,KAAKjB,SAASkB,cAChB,IAEHrC,IAAIoB,aAAa,SAEjBW,YAAY,qBAEbO,MAAO,WACN3C,IACAuB,EAAKe,SAAWf,EAAKqB,WAAY,EACjCvC,IAAIoB,aAAa,QAASpB,IAAIa,GAAGC,KAAKN,OAAOgC,QAAQ,QAAStB,EAAKM,QAElExB,IAAIa,GAAGC,KAAKR,UAIf,OAFAN,IAAIC,IAAMR,EAAEqB,KAAKO,GAEV","file":"../ajax.js","sourcesContent":["define([\n\t\"skylark-jquery\",\n\t\"./core\"\n],function($) {\n\tvar AJAX_NS = 'ajax',\n\t\t_ajaxCur,\n\t\t_removeAjaxCursor = function() {\n\t\t\tif(_ajaxCur) {\n\t\t\t\t$(document.body).removeClass(_ajaxCur);\n\t\t\t}\n\t\t},\n\t\t_destroyAjaxRequest = function() {\n\t\t\t_removeAjaxCursor();\n\t\t\tif(mfp.req) {\n\t\t\t\tmfp.req.abort();\n\t\t\t}\n\t\t};\n\n\t$.magnificPopup.registerModule(AJAX_NS, {\n\n\t\toptions: {\n\t\t\tsettings: null,\n\t\t\tcursor: 'mfp-ajax-cur',\n\t\t\ttError: '<a href=\"%url%\">The content</a> could not be loaded.'\n\t\t},\n\n\t\tproto: {\n\t\t\tinitAjax: function() {\n\t\t\t\tmfp.types.push(AJAX_NS);\n\t\t\t\t_ajaxCur = mfp.st.ajax.cursor;\n\n\t\t\t\t_mfpOn(CLOSE_EVENT+'.'+AJAX_NS, _destroyAjaxRequest);\n\t\t\t\t_mfpOn('BeforeChange.' + AJAX_NS, _destroyAjaxRequest);\n\t\t\t},\n\t\t\tgetAjax: function(item) {\n\n\t\t\t\tif(_ajaxCur) {\n\t\t\t\t\t$(document.body).addClass(_ajaxCur);\n\t\t\t\t}\n\n\t\t\t\tmfp.updateStatus('loading');\n\n\t\t\t\tvar opts = $.extend({\n\t\t\t\t\turl: item.src,\n\t\t\t\t\tsuccess: function(data, textStatus, jqXHR) {\n\t\t\t\t\t\tvar temp = {\n\t\t\t\t\t\t\tdata:data,\n\t\t\t\t\t\t\txhr:jqXHR\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t_mfpTrigger('ParseAjax', temp);\n\n\t\t\t\t\t\tmfp.appendContent( $(temp.data), AJAX_NS );\n\n\t\t\t\t\t\titem.finished = true;\n\n\t\t\t\t\t\t_removeAjaxCursor();\n\n\t\t\t\t\t\tmfp._setFocus();\n\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tmfp.wrap.addClass(READY_CLASS);\n\t\t\t\t\t\t}, 16);\n\n\t\t\t\t\t\tmfp.updateStatus('ready');\n\n\t\t\t\t\t\t_mfpTrigger('AjaxContentAdded');\n\t\t\t\t\t},\n\t\t\t\t\terror: function() {\n\t\t\t\t\t\t_removeAjaxCursor();\n\t\t\t\t\t\titem.finished = item.loadError = true;\n\t\t\t\t\t\tmfp.updateStatus('error', mfp.st.ajax.tError.replace('%url%', item.src));\n\t\t\t\t\t}\n\t\t\t\t}, mfp.st.ajax.settings);\n\n\t\t\t\tmfp.req = $.ajax(opts);\n\n\t\t\t\treturn '';\n\t\t\t}\n\t\t}\n\t});\n});"]}